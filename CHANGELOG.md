# Changelog

Все значимые изменения в этом проекте будут документированы в этом файле.

Формат основан на [Keep a Changelog](https://keepachangelog.com/ru/1.0.0/),
и этот проект придерживается [Semantic Versioning](https://semver.org/lang/ru/).

## [v1.1.0] - 2025-01-14

### Added

- **Новый класс WC_JS_Cart_Funcs** для реализации JavaScript функций работы с корзиной WooCommerce
- **Глобальный объект `window.digiLayer`** с тремя основными методами:
  - `addToCart(productId, quantity)` - добавление товара в корзину
  - `removeFromCart(productId)` - удаление товара из корзины
  - `cartState()` - получение текущего состояния корзины
- **AJAX обработчики** для всех операций с корзиной:
  - `wp_ajax_add_to_cart` и `wp_ajax_nopriv_add_to_cart`
  - `wp_ajax_remove_from_cart` и `wp_ajax_nopriv_remove_from_cart`
  - `wp_ajax_get_cart_state` и `wp_ajax_nopriv_get_cart_state`
- **Режим отладки** с условным логированием (только при `WP_DEBUG = true`)
- **JavaScript файл** `assets/js/cart-funcs.js` с полной реализацией функций
- **Тестовый HTML файл** `test-cart-functions.html` для демонстрации работы
- **Обновленная документация** с примерами использования и отладочной информацией

### Changed

- Обновлен основной файл плагина для подключения нового класса
- Расширена архитектура плагина для поддержки JavaScript функциональности
- Обновлен README.md с подробным описанием новых возможностей

### Technical

- Все JavaScript функции возвращают Promise для асинхронной работы
- Реализована безопасность через WordPress nonce
- Добавлена валидация входных данных на стороне сервера
- Интеграция с WooCommerce API для работы с корзиной
- Поддержка как авторизованных, так и неавторизованных пользователей

## [v1.0.1]

### Added

- Поддержка извлечения номера заказа из URL с помощью регулярного выражения
- Логирование ошибок для отладки (при включенном WP_DEBUG)

### Changed

- Улучшена логика получения order_id в классе WC_Meta_ThankYou
- Добавлена обратная совместимость с различными форматами URL

### Fixed

- Исправлена проблема с получением номера заказа из URL формата `/checkout/order-received/388355/`

## [1.0.0] - 2025-01-30

### Added

- Базовый функционал плагина для вывода мета-свойств WooCommerce
- Класс WC_Meta_Page для базовой функциональности
- Класс WC_Meta_ThankYou для страницы "Спасибо за заказ"
- Вывод мета-свойств:
  - `wc-order-status` - статус заказа
  - `wc-order-total` - общая сумма заказа
  - `wc-customer-id` - ID покупателя (если есть)
- Поддержка Docker для разработки
- Базовая структура плагина WordPress

### Technical

- Создана архитектура плагина с использованием пространств имен
- Реализована система активации/деактивации плагина
- Добавлена поддержка различных форматов URL для получения order_id 
